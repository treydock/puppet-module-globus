<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-puppet-globus">puppet-globus</h1>

<p><a href="https://forge.puppetlabs.com/treydock/globus"><img
src="http://img.shields.io/puppetforge/v/treydock/globus.svg"></a> <a
href="https://github.com/treydock/puppet-module-globus/actions?query=workflow%3ACI"><img
src="https://github.com/treydock/puppet-module-globus/workflows/CI/badge.svg?branch=master"></a></p>

<h2 id="label-Overview">Overview</h2>

<p>This module manages Globus Connect Server.</p>

<h3 id="label-Supported+Versions+of+Globus">Supported Versions of Globus</h3>

<p>Currently this module supports Globus 4.x and 5.4.</p>

<p>| Globus Version | Globus Puppet module versions | | ————– | —————————– | |
4.x | 3.x | | 4.x &amp; 5.3 | 4.x | | 4.x &amp; 5.4 | 5.x |</p>

<h3 id="label-Upgrading+to+module+version+5.x">Upgrading to module version 5.x</h3>

<p>Going from a version of this module prior to 5.0.0 to 5.x and using Globus
v5 requires manual upgrade be performed.</p>

<p>See <a
href="https://docs.globus.org/globus-connect-server/v5.4/migration-guide/">Globus
v5.4 Migration Guide</a> for details.</p>

<p>For sites using Globus v4 it&#39;s necessary to set
<code>globus::version</code> to <code>4</code> in order to continue using
Globus v4 as the default version was changed.</p>

<p>For sites using Globus v5.3 and upgrading this module 5.x, it&#39;s
expected you are also upgrading to Globus v5.4. The parameters completely
changed for Globus v5 support so see the examples below for changes needed
and required parameters.</p>

<h2 id="label-Usage">Usage</h2>

<h3 id="label-Globus+v5.4">Globus v5.4</h3>

<p>The steps performed by this module are to install Globus and run the
<code>globus endpoint setup</code> and <code>globus node setup</code>
commands.</p>

<p>The following is the minimum parameters that must be passed to setup Globus
v5.4.</p>

<pre class="code ruby"><code class="ruby">class { &#39;globus&#39;:
  display_name  =&gt; &#39;REPLACE My Site Globus&#39;,
  client_id     =&gt; &#39;REPLACE-client-id-from-globus&#39;,
  client_secret =&gt; &#39;REPLACE-client-id-from-globus&#39;,
  owner         =&gt; &#39;REPLACE-user@example.com&#39;,
  organization  =&gt; &#39;REPLACE-My Site&#39;,
}
</code></pre>

<h3 id="label-Globus+v4">Globus v4</h3>

<p>Install and configure a Globus IO endpoint that uses OAuth. This example
assumes host cert/key will not be provided by Globus.</p>

<pre class="code ruby"><code class="ruby">class { &#39;globus&#39;:
  include_id_server =&gt; false,
  globus_user =&gt; &#39;myusername&#39;,
  globus_password =&gt; &#39;password&#39;,
  endpoint_name =&gt; &#39;myorg&#39;,
  endpoint_public =&gt; true,
  myproxy_server =&gt; &#39;myproxy.example.com:7512&#39;,
  oauth_server =&gt; &#39;myproxy.example.com&#39;,
  security_identity_method =&gt; &#39;OAuth&#39;,
  security_fetch_credentials_from_relay =&gt; false,
  security_certificate_file =&gt; &#39;/etc/grid-security/hostcert.pem&#39;,
  security_key_file =&gt; &#39;/etc/grid-security/hostkey.pem&#39;,
  gridftp_server =&gt; $::fqdn,
  gridftp_restrict_paths =&gt; [&#39;RW~&#39;,&#39;N~/.*&#39;,&#39;RW/project&#39;],
  # Example of extra settings
  extra_gridftp_settings =&gt; [
    &#39;log_level ALL&#39;,
    &#39;log_single /var/log/gridftp-auth.log&#39;,
    &#39;log_transfer /var/log/gridftp-transfer.log&#39;,
  ],
}
</code></pre>

<p>This is an example of setting up a system that acts as both MyProxy and
OAuth host. This example assumes the host cert/key are not provided by
Globus.</p>

<pre class="code ruby"><code class="ruby">class { &#39;globus&#39;:
    include_io_server =&gt; false,
    include_id_server =&gt; true,
    include_oauth_server =&gt; true,
    globus_user =&gt; &#39;myusername&#39;,
    globus_password =&gt; &#39;password&#39;,
    endpoint_name =&gt; &#39;myorg&#39;,
    endpoint_public =&gt; true,
    myproxy_server =&gt; &#39;myproxy.example.com:7512&#39;,
    oauth_server =&gt; &#39;myproxy.example.com&#39;,
    security_identity_method =&gt; &#39;OAuth&#39;,
    security_fetch_credentials_from_relay =&gt; false,
    security_certificate_file =&gt; &#39;/etc/grid-security/hostcert.pem&#39;,
    security_key_file =&gt; &#39;/etc/grid-security/hostkey.pem&#39;,
  }
</code></pre>

<p>Below is an example of setting up the IO server to use CILogon.</p>

<pre class="code ruby"><code class="ruby">class { &#39;globus&#39;:
    include_id_server =&gt; false,
    globus_user =&gt; &#39;myusername&#39;,
    globus_password =&gt; &#39;password&#39;,
    endpoint_name =&gt; &#39;myorg&#39;,
    endpoint_public =&gt; true,
    myproxy_server =&gt; &#39;myproxy.example.com:7512&#39;,
    oauth_server =&gt; &#39;myproxy.example.com&#39;,
    security_identity_method =&gt; &#39;CILogon&#39;,
    security_cilogon_identity_provider =&gt; &#39;My Org&#39;,
    security_fetch_credentials_from_relay =&gt; false,
    security_certificate_file =&gt; &#39;/etc/grid-security/hostcert.pem&#39;,
    security_key_file =&gt; &#39;/etc/grid-security/hostkey.pem&#39;,
    gridftp_server =&gt; $::fqdn,
    gridftp_restrict_paths =&gt; [&#39;RW~&#39;,&#39;N~/.*&#39;,&#39;RW/project&#39;],
    # Example of extra settings
    extra_gridftp_settings =&gt; [
      &#39;log_level ALL&#39;,
      &#39;log_single /var/log/gridftp-auth.log&#39;,
      &#39;log_transfer /var/log/gridftp-transfer.log&#39;,
    ],
  }
</code></pre>

<p>Below is an example of what would be required to setup Globus GridFTP to
also work with OSG GridFTP. This example has not been verified since OSG
3.3. OSG module referenced: <a
href="https://github.com/treydock/puppet-osg">github.com/treydock/puppet-osg</a></p>

<pre class="code ruby"><code class="ruby">include ::osg
  include ::osg::gridftp
  class { &#39;::globus&#39;:
    manage_service =&gt; false,
    include_id_server =&gt; false,
    remove_cilogon_cron =&gt; true,
    extra_gridftp_settings =&gt; [
      &#39;log_level ALL&#39;
      &#39;log_single /var/log/gridftp-auth.log&#39;
      &#39;log_transfer /var/log/gridftp.log&#39;
      &#39;$LLGT_LOG_IDENT &quot;gridftp-server-llgt&quot;&#39;
      &#39;$LCMAPS_DB_FILE &quot;/etc/lcmaps.db&quot;&#39;
      &#39;$LCMAPS_POLICY_NAME &quot;authorize_only&quot;&#39;
      &#39;$LLGT_LIFT_PRIVILEGED_PROTECTION &quot;1&quot;&#39;
      &#39;$LCMAPS_DEBUG_LEVEL &quot;2&quot;&#39;
      &#39;$FTPNOSORT 1&#39;
    ],
    first_gridftp_callback =&gt; &#39;|globus_mapping liblcas_lcmaps_gt4_mapping.so lcmaps_callout&#39;,
  }
  
  # Add globus repo before installing OSG GridFTP
  Yumrepo[&#39;Globus-Toolkit&#39;] -&gt; Package[&#39;osg-gridftp&#39;]
  # Apply OSG GridFTP before Globus
  Package[&#39;osg-gridftp&#39;] -&gt; Class[&#39;::globus::install&#39;]
</code></pre>

<h3 id="label-Globus+CLI">Globus CLI</h3>

<p>To install the Globus CLI to <code>/opt/globus-cli</code> and create
symlink for executable at <code>/usr/bin/globus</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid_globus'>globus</span><span class='op'>::</span><span class='id identifier rubyid_cli'>cli</span>
</code></pre>

<h3 id="label-Globus+SDK">Globus SDK</h3>

<p>To install the Globus SDK to <code>/opt/globus-sdk</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_include'>include</span> <span class='id identifier rubyid_globus'>globus</span><span class='op'>::</span><span class='id identifier rubyid_sdk'>sdk</span>
</code></pre>

<h3 id="label-Facts">Facts</h3>

<p>The <code>globus_info</code> fact exposes the information stored in
<code>/var/lib/globus-connect-server/info.json</code>. Example:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># facter -p globus_info
</span><span class='lbrace'>{</span>
  <span class='id identifier rubyid_endpoint_id'>endpoint_id</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1c6b6e6a-3791-4213-b3e6-00000001</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='id identifier rubyid_domain_name'>domain_name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>00000001.8443.data.globus.org</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='id identifier rubyid_manager_version'>manager_version</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5.4.11</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='const'>DATA_TYPE</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>info#1.0.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='id identifier rubyid_client_id'>client_id</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1c6b6e6a-3791-4213-b3e6-00000001</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='id identifier rubyid_api_version'>api_version</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.3.0</span><span class='tstring_end'>&quot;</span></span>
<span class='rbrace'>}</span>
</code></pre>

<h2 id="label-Reference">Reference</h2>

<p><a
href="http://treydock.github.io/puppet-module-globus/">treydock.github.io/puppet-module-globus/</a></p>

<h2 id="label-Compatibility">Compatibility</h2>

<p>Tested using</p>
<ul><li>
<p>RedHat/CentOS 7</p>
</li><li>
<p>RedHat/CentOS 8</p>
</li><li>
<p>Debian 9</p>
</li><li>
<p>Debian 10</p>
</li><li>
<p>Ubuntu 18.04</p>
</li><li>
<p>Ubuntu 20.04</p>
</li></ul>

<h2 id="label-Limitations">Limitations</h2>

<p>At this time <code>globus::cli</code> and <code>globus::sdk</code> are not
supported on Ubuntu 20.04 due to limitations in the Python module</p>
</div></div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>